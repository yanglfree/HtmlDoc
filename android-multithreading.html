<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Androidå¤šçº¿ç¨‹æŠ€æœ¯ - å¿«é€ŸæŸ¥è¯¢æ‰‹å†Œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0d1117;
            --bg2: #161b22;
            --bg3: #21262d;
            --text: #e6edf3;
            --text2: #8b949e;
            --blue: #58a6ff;
            --green: #3fb950;
            --purple: #a371f7;
            --orange: #d29922;
            --cyan: #39c5cf;
            --border: #30363d
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 24px
        }

        .hero {
            text-align: center;
            padding: 48px 24px;
            margin-bottom: 48px;
            background: linear-gradient(135deg, rgba(163, 113, 247, 0.15), rgba(57, 197, 207, 0.15));
            border-radius: 16px;
            border: 1px solid var(--border)
        }

        .hero h1 {
            font-size: 34px;
            margin-bottom: 12px;
            background: linear-gradient(135deg, var(--purple), var(--cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent
        }

        .hero p {
            color: var(--text2);
            font-size: 16px
        }

        .section {
            margin-bottom: 48px
        }

        .section h2 {
            font-size: 22px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px
        }

        .section h2::before {
            content: '';
            width: 4px;
            height: 22px;
            background: linear-gradient(var(--purple), var(--cyan));
            border-radius: 2px
        }

        .section h3 {
            font-size: 18px;
            margin: 24px 0 16px;
            color: var(--purple)
        }

        p {
            margin-bottom: 16px;
            color: var(--text2)
        }

        code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg3);
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 13px;
            color: var(--cyan)
        }

        pre {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.8;
            margin: 16px 0
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text)
        }

        .comment {
            color: var(--text2)
        }

        .keyword {
            color: var(--purple)
        }

        .string {
            color: var(--green)
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 20px 0
        }

        .card {
            background: var(--bg2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            transition: all .2s
        }

        .card:hover {
            border-color: var(--purple);
            transform: translateY(-2px)
        }

        .card h3 {
            font-size: 16px;
            color: var(--purple);
            margin-bottom: 12px
        }

        .card p,
        .card li {
            font-size: 14px;
            color: var(--text2);
            margin: 0
        }

        .card ul {
            margin: 8px 0 0 16px
        }

        .tip {
            background: rgba(163, 113, 247, 0.1);
            border: 1px solid rgba(163, 113, 247, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            margin: 20px 0
        }

        .tip.warn {
            background: rgba(210, 153, 34, 0.1);
            border-color: rgba(210, 153, 34, 0.3)
        }

        .tip.success {
            background: rgba(63, 185, 80, 0.1);
            border-color: rgba(63, 185, 80, 0.3)
        }

        .tip strong {
            display: block;
            margin-bottom: 6px;
            color: var(--purple)
        }

        .tip.warn strong {
            color: var(--orange)
        }

        .tip.success strong {
            color: var(--green)
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            background: var(--bg2);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
            margin: 16px 0
        }

        th {
            background: var(--bg3);
            padding: 14px 16px;
            text-align: left;
            font-weight: 600
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            vertical-align: top
        }

        tr:last-child td {
            border-bottom: none
        }

        .toc {
            position: fixed;
            top: 40px;
            right: 40px;
            width: 200px;
            background: var(--bg2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px
        }

        .toc h3 {
            font-size: 12px;
            color: var(--text2);
            text-transform: uppercase;
            margin-bottom: 12px
        }

        .toc a {
            display: block;
            padding: 6px 0;
            color: var(--text2);
            text-decoration: none;
            font-size: 13px
        }

        .toc a:hover {
            color: var(--purple)
        }

        @media(max-width:1200px) {
            .toc {
                display: none
            }
        }

        @media(max-width:768px) {
            .container {
                padding: 24px 16px
            }

            .hero h1 {
                font-size: 26px
            }

            .cards {
                grid-template-columns: 1fr
            }
        }
    </style>
</head>

<body>
    <nav class="toc">
        <h3>ç›®å½•</h3><a href="#overview">æ¦‚è§ˆ</a><a href="#thread">ThreadåŸºç¡€</a><a href="#handler">Handleræœºåˆ¶</a><a
            href="#executor">çº¿ç¨‹æ± </a><a href="#asynctask">AsyncTask</a><a href="#coroutine">Kotlinåç¨‹</a><a
            href="#rxjava">RxJava</a><a href="#workmanager">WorkManager</a><a href="#compare">æŠ€æœ¯å¯¹æ¯”</a>
    </nav>

    <div class="container">
        <div class="hero">
            <h1>ğŸ”„ Androidå¤šçº¿ç¨‹æŠ€æœ¯</h1>
            <p>Thread Â· Handler Â· çº¿ç¨‹æ±  Â· åç¨‹ Â· RxJava Â· WorkManager</p>
        </div>

        <section id="overview" class="section">
            <h2>å¤šçº¿ç¨‹æ¦‚è§ˆ</h2>
            <p>Android UIæ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œè€—æ—¶æ“ä½œéœ€è¦æ”¾åˆ°åå°çº¿ç¨‹ï¼Œç„¶ååˆ‡å›ä¸»çº¿ç¨‹æ›´æ–°UIã€‚</p>

            <div class="cards">
                <div class="card">
                    <h3>ğŸ¯ ä¸»çº¿ç¨‹(UIçº¿ç¨‹)</h3>
                    <ul>
                        <li>å¤„ç†UIæ¸²æŸ“å’Œäº¤äº’</li>
                        <li>ä¸èƒ½æ‰§è¡Œè€—æ—¶æ“ä½œ</li>
                        <li>ANRé˜ˆå€¼ï¼š5ç§’</li>
                    </ul>
                </div>
                <div class="card">
                    <h3">âš™ï¸ åå°çº¿ç¨‹</h3>
                        <ul>
                            <li>æ‰§è¡Œç½‘ç»œè¯·æ±‚ã€IOæ“ä½œ</li>
                            <li>ä¸èƒ½ç›´æ¥æ“ä½œUI</li>
                            <li>éœ€åˆ‡æ¢å›ä¸»çº¿ç¨‹æ›´æ–°UI</li>
                        </ul>
                </div>
                <div class="card">
                    <h3">ğŸ”€ çº¿ç¨‹é€šä¿¡</h3>
                        <ul>
                            <li>Handler/Looperæœºåˆ¶</li>
                            <li>runOnUiThread()</li>
                            <li>View.post()</li>
                        </ul>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>æŠ€æœ¯</th>
                        <th>é€‚ç”¨åœºæ™¯</th>
                        <th>ç‰¹ç‚¹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Thread + Handler</td>
                        <td>ç®€å•çš„åå°ä»»åŠ¡</td>
                        <td>åŸºç¡€ï¼Œéœ€æ‰‹åŠ¨ç®¡ç†</td>
                    </tr>
                    <tr>
                        <td>çº¿ç¨‹æ±  (Executor)</td>
                        <td>æ‰¹é‡å¹¶å‘ä»»åŠ¡</td>
                        <td>å¤ç”¨çº¿ç¨‹ï¼Œå¯æ§å¹¶å‘</td>
                    </tr>
                    <tr>
                        <td>Kotlin åç¨‹</td>
                        <td>ç°ä»£Androidå¼€å‘é¦–é€‰</td>
                        <td>ç®€æ´ã€ç»“æ„åŒ–å¹¶å‘</td>
                    </tr>
                    <tr>
                        <td>RxJava</td>
                        <td>å¤æ‚æ•°æ®æµå¤„ç†</td>
                        <td>å“åº”å¼ç¼–ç¨‹</td>
                    </tr>
                    <tr>
                        <td>WorkManager</td>
                        <td>å¯é çš„åå°ä»»åŠ¡</td>
                        <td>ç³»ç»Ÿè°ƒåº¦ã€æ”¯æŒçº¦æŸ</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="thread" class="section">
            <h2>Thread åŸºç¡€</h2>

            <pre><code><span class="comment">// æ–¹å¼1: ç»§æ‰¿Thread</span>
<span class="keyword">class</span> MyThread : Thread() {
    <span class="keyword">override fun</span> run() {
        <span class="comment">// åå°ä»»åŠ¡</span>
    }
}
MyThread().start()

<span class="comment">// æ–¹å¼2: å®ç°Runnable</span>
Thread {
    <span class="comment">// åå°ä»»åŠ¡</span>
    doBackgroundWork()
    
    <span class="comment">// åˆ‡å›ä¸»çº¿ç¨‹æ›´æ–°UI</span>
    runOnUiThread {
        textView.text = <span class="string">"å®Œæˆ"</span>
    }
}.start()

<span class="comment">// ä½¿ç”¨View.post()åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹</span>
Thread {
    <span class="keyword">val</span> result = fetchData()
    textView.post {
        textView.text = result
    }
}.start()</code></pre>

            <div class="tip warn"><strong>âš ï¸ ç›´æ¥ä½¿ç”¨Threadçš„é—®é¢˜</strong>
                <p style="margin-top:8px">â€¢ çº¿ç¨‹åˆ›å»ºé”€æ¯å¼€é”€å¤§<br>â€¢ æ— æ³•å¤ç”¨çº¿ç¨‹<br>â€¢ éš¾ä»¥ç®¡ç†å¹¶å‘æ•°é‡<br>â€¢ éœ€æ‰‹åŠ¨å¤„ç†çº¿ç¨‹é€šä¿¡</p>
            </div>
        </section>

        <section id="handler" class="section">
            <h2>Handler æœºåˆ¶</h2>
            <p>Handler æ˜¯ Android çº¿ç¨‹é—´é€šä¿¡çš„æ ¸å¿ƒæœºåˆ¶ï¼Œè¯¦ç»†åŸç†è¯·å‚è€ƒã€ŠAndroidæ¶ˆæ¯æœºåˆ¶ã€‹æ‰‹å†Œã€‚</p>

            <pre><code><span class="comment">// ä¸»çº¿ç¨‹Handler</span>
<span class="keyword">private val</span> mainHandler = Handler(Looper.getMainLooper())

<span class="comment">// åå°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œç»“æœåˆ‡å›ä¸»çº¿ç¨‹</span>
Thread {
    <span class="keyword">val</span> result = doHeavyWork()
    
    mainHandler.post {
        updateUI(result)
    }
}.start()

<span class="comment">// HandlerThread - å¸¦Looperçš„åå°çº¿ç¨‹</span>
<span class="keyword">val</span> handlerThread = HandlerThread(<span class="string">"BackgroundThread"</span>)
handlerThread.start()

<span class="keyword">val</span> backgroundHandler = Handler(handlerThread.looper)
backgroundHandler.post {
    <span class="comment">// åœ¨åå°çº¿ç¨‹æ‰§è¡Œ</span>
}

<span class="comment">// ä¸ç”¨æ—¶è®°å¾—é€€å‡º</span>
handlerThread.quitSafely()</code></pre>
        </section>

        <section id="executor" class="section">
            <h2>çº¿ç¨‹æ±  ExecutorService</h2>
            <p>çº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»ºé”€æ¯ï¼Œå¯æ§åˆ¶å¹¶å‘æ•°é‡ã€‚</p>

            <h3>å¸¸ç”¨çº¿ç¨‹æ± </h3>
            <table>
                <thead>
                    <tr>
                        <th>ç±»å‹</th>
                        <th>åˆ›å»ºæ–¹å¼</th>
                        <th>ç‰¹ç‚¹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>å›ºå®šå¤§å°</td>
                        <td><code>Executors.newFixedThreadPool(n)</code></td>
                        <td>å›ºå®šnä¸ªçº¿ç¨‹</td>
                    </tr>
                    <tr>
                        <td>ç¼“å­˜æ± </td>
                        <td><code>Executors.newCachedThreadPool()</code></td>
                        <td>æŒ‰éœ€åˆ›å»ºï¼Œç©ºé—²å›æ”¶</td>
                    </tr>
                    <tr>
                        <td>å•çº¿ç¨‹</td>
                        <td><code>Executors.newSingleThreadExecutor()</code></td>
                        <td>å•çº¿ç¨‹é¡ºåºæ‰§è¡Œ</td>
                    </tr>
                    <tr>
                        <td>è°ƒåº¦æ± </td>
                        <td><code>Executors.newScheduledThreadPool(n)</code></td>
                        <td>å®šæ—¶/å‘¨æœŸä»»åŠ¡</td>
                    </tr>
                </tbody>
            </table>

            <pre><code><span class="comment">// åˆ›å»ºçº¿ç¨‹æ± </span>
<span class="keyword">private val</span> executor = Executors.newFixedThreadPool(4)

<span class="comment">// æäº¤ä»»åŠ¡</span>
executor.execute {
    <span class="comment">// åå°ä»»åŠ¡</span>
    <span class="keyword">val</span> result = fetchData()
    mainHandler.post { updateUI(result) }
}

<span class="comment">// å¸¦è¿”å›å€¼çš„ä»»åŠ¡</span>
<span class="keyword">val</span> future = executor.submit(Callable {
    fetchData()
})
<span class="keyword">val</span> result = future.get()  <span class="comment">// é˜»å¡è·å–ç»“æœ</span>

<span class="comment">// è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼ˆæ¨èï¼‰</span>
<span class="keyword">val</span> executor = ThreadPoolExecutor(
    2,                      <span class="comment">// æ ¸å¿ƒçº¿ç¨‹æ•°</span>
    4,                      <span class="comment">// æœ€å¤§çº¿ç¨‹æ•°</span>
    60L, TimeUnit.SECONDS,  <span class="comment">// ç©ºé—²è¶…æ—¶</span>
    LinkedBlockingQueue(100),<span class="comment">// ä»»åŠ¡é˜Ÿåˆ—</span>
    ThreadFactory { r -> Thread(r, <span class="string">"MyPool"</span>) }
)

<span class="comment">// å…³é—­çº¿ç¨‹æ± </span>
executor.shutdown()</code></pre>
        </section>

        <section id="asynctask" class="section">
            <h2>AsyncTaskï¼ˆå·²åºŸå¼ƒï¼‰</h2>
            <p>Android 11 (API 30) å¼€å§‹å·²åºŸå¼ƒï¼Œäº†è§£å³å¯ï¼Œæ–°é¡¹ç›®è¯·ä½¿ç”¨åç¨‹ã€‚</p>

            <pre><code><span class="comment">// âŒ å·²åºŸå¼ƒï¼Œä»…ä½œå‚è€ƒ</span>
<span class="keyword">class</span> MyTask : AsyncTask&lt;String, Int, String&gt;() {
    <span class="keyword">override fun</span> doInBackground(vararg params: String): String {
        <span class="comment">// åå°çº¿ç¨‹æ‰§è¡Œ</span>
        <span class="keyword">for</span> (i <span class="keyword">in</span> 0..100) {
            publishProgress(i)  <span class="comment">// æ›´æ–°è¿›åº¦</span>
        }
        <span class="keyword">return</span> <span class="string">"ç»“æœ"</span>
    }
    
    <span class="keyword">override fun</span> onProgressUpdate(vararg values: Int) {
        <span class="comment">// ä¸»çº¿ç¨‹æ›´æ–°è¿›åº¦</span>
        progressBar.progress = values[0]
    }
    
    <span class="keyword">override fun</span> onPostExecute(result: String) {
        <span class="comment">// ä¸»çº¿ç¨‹å¤„ç†ç»“æœ</span>
        textView.text = result
    }
}</code></pre>

            <div class="tip warn"><strong>âš ï¸ AsyncTaské—®é¢˜</strong>
                <p style="margin-top:8px">â€¢ å†…å­˜æ³„æ¼é£é™©ï¼ˆæŒæœ‰Activityå¼•ç”¨ï¼‰<br>â€¢ é»˜è®¤ä¸²è¡Œæ‰§è¡Œ<br>â€¢ ç”Ÿå‘½å‘¨æœŸå¤„ç†å›°éš¾<br>â€¢ å·²è¢«å®˜æ–¹åºŸå¼ƒ</p>
            </div>
        </section>

        <section id="coroutine" class="section">
            <h2>Kotlin åç¨‹ â­ æ¨è</h2>
            <p>Kotlinåç¨‹æ˜¯ç°ä»£Androidå¼€å‘çš„é¦–é€‰å¼‚æ­¥æ–¹æ¡ˆï¼Œè¯­æ³•ç®€æ´ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚</p>

            <h3>åŸºç¡€ç”¨æ³•</h3>
            <pre><code><span class="comment">// ä¾èµ–</span>
<span class="comment">// implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3"</span>

<span class="comment">// åœ¨ViewModelä¸­ä½¿ç”¨</span>
<span class="keyword">class</span> MyViewModel : ViewModel() {
    <span class="keyword">fun</span> fetchData() {
        viewModelScope.launch {
            <span class="comment">// ä¸»çº¿ç¨‹</span>
            showLoading()
            
            <span class="keyword">val</span> result = withContext(Dispatchers.IO) {
                <span class="comment">// IOçº¿ç¨‹æ‰§è¡Œç½‘ç»œè¯·æ±‚</span>
                api.getData()
            }
            
            <span class="comment">// è‡ªåŠ¨åˆ‡å›ä¸»çº¿ç¨‹</span>
            updateUI(result)
        }
    }
}

<span class="comment">// åœ¨Activity/Fragmentä¸­</span>
lifecycleScope.launch {
    <span class="keyword">val</span> data = withContext(Dispatchers.IO) {
        repository.fetchData()
    }
    textView.text = data
}</code></pre>

            <h3>è°ƒåº¦å™¨ (Dispatcher)</h3>
            <table>
                <thead>
                    <tr>
                        <th>è°ƒåº¦å™¨</th>
                        <th>ç”¨é€”</th>
                        <th>çº¿ç¨‹æ± </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Dispatchers.Main</code></td>
                        <td>UIæ“ä½œ</td>
                        <td>ä¸»çº¿ç¨‹</td>
                    </tr>
                    <tr>
                        <td><code>Dispatchers.IO</code></td>
                        <td>ç½‘ç»œã€æ–‡ä»¶IO</td>
                        <td>å…±äº«IOçº¿ç¨‹æ± </td>
                    </tr>
                    <tr>
                        <td><code>Dispatchers.Default</code></td>
                        <td>CPUå¯†é›†è®¡ç®—</td>
                        <td>CPUæ ¸å¿ƒæ•°çº¿ç¨‹</td>
                    </tr>
                    <tr>
                        <td><code>Dispatchers.Unconfined</code></td>
                        <td>ä¸é™å®šçº¿ç¨‹</td>
                        <td>å½“å‰çº¿ç¨‹</td>
                    </tr>
                </tbody>
            </table>

            <h3>å¹¶å‘ä¸å¼‚å¸¸å¤„ç†</h3>
            <pre><code><span class="comment">// å¹¶è¡Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡</span>
lifecycleScope.launch {
    <span class="keyword">val</span> deferred1 = async(Dispatchers.IO) { fetchUser() }
    <span class="keyword">val</span> deferred2 = async(Dispatchers.IO) { fetchPosts() }
    
    <span class="keyword">val</span> user = deferred1.await()
    <span class="keyword">val</span> posts = deferred2.await()
    
    showUserWithPosts(user, posts)
}

<span class="comment">// å¼‚å¸¸å¤„ç†</span>
viewModelScope.launch {
    <span class="keyword">try</span> {
        <span class="keyword">val</span> result = withContext(Dispatchers.IO) {
            api.fetchData()
        }
        onSuccess(result)
    } <span class="keyword">catch</span> (e: Exception) {
        onError(e)
    }
}

<span class="comment">// ä½¿ç”¨ supervisorScope éš”ç¦»å­åç¨‹å¤±è´¥</span>
supervisorScope {
    launch { task1() }  <span class="comment">// å¤±è´¥ä¸å½±å“task2</span>
    launch { task2() }
}</code></pre>

            <div class="tip success"><strong>âœ… åç¨‹ä¼˜åŠ¿</strong>
                <p style="margin-top:8px">â€¢ ä»£ç ç®€æ´ï¼ŒåƒåŒæ­¥ä»£ç ä¸€æ ·å†™å¼‚æ­¥<br>â€¢ ç»“æ„åŒ–å¹¶å‘ï¼Œè‡ªåŠ¨å–æ¶ˆç®¡ç†<br>â€¢ è½»é‡çº§ï¼Œå¯åˆ›å»ºå¤§é‡åç¨‹<br>â€¢ ä¸Jetpackå®Œç¾é›†æˆ</p>
            </div>
        </section>

        <section id="rxjava" class="section">
            <h2>RxJava</h2>
            <p>å“åº”å¼ç¼–ç¨‹åº“ï¼Œé€šè¿‡è§‚å¯Ÿè€…æ¨¡å¼å¤„ç†å¼‚æ­¥æ•°æ®æµï¼Œé€‚åˆå¤æ‚çš„æ•°æ®å˜æ¢åœºæ™¯ã€‚</p>

            <pre><code><span class="comment">// åŸºæœ¬ç”¨æ³•</span>
Observable.just(<span class="string">"Hello"</span>)
    .subscribeOn(Schedulers.io())        <span class="comment">// ä¸Šæ¸¸åœ¨IOçº¿ç¨‹</span>
    .observeOn(AndroidSchedulers.mainThread())  <span class="comment">// ä¸‹æ¸¸åœ¨ä¸»çº¿ç¨‹</span>
    .subscribe(
        { result -> textView.text = result },
        { error -> showError(error) }
    )

<span class="comment">// é“¾å¼æ“ä½œ</span>
api.getUsers()
    .subscribeOn(Schedulers.io())
    .map { users -> users.filter { it.isActive } }
    .flatMap { users -> 
        Observable.fromIterable(users)
            .flatMap { user -> api.getDetails(user.id) }
            .toList()
            .toObservable()
    }
    .observeOn(AndroidSchedulers.mainThread())
    .subscribe { details -> showDetails(details) }

<span class="comment">// é˜²æ­¢å†…å­˜æ³„æ¼ - CompositeDisposable</span>
<span class="keyword">private val</span> disposables = CompositeDisposable()

disposables.add(
    api.getData()
        .subscribeOn(Schedulers.io())
        .observeOn(AndroidSchedulers.mainThread())
        .subscribe()
)

<span class="comment">// onDestroyä¸­æ¸…ç†</span>
<span class="keyword">override fun</span> onDestroy() {
    disposables.clear()
    <span class="keyword">super</span>.onDestroy()
}</code></pre>

            <h3>å¸¸ç”¨æ“ä½œç¬¦</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ“ä½œç¬¦</th>
                        <th>ä½œç”¨</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>map</code></td>
                        <td>è½¬æ¢æ¯ä¸ªå…ƒç´ </td>
                    </tr>
                    <tr>
                        <td><code>flatMap</code></td>
                        <td>è½¬æ¢ä¸ºæ–°çš„Observable</td>
                    </tr>
                    <tr>
                        <td><code>filter</code></td>
                        <td>è¿‡æ»¤å…ƒç´ </td>
                    </tr>
                    <tr>
                        <td><code>debounce</code></td>
                        <td>é˜²æŠ–ï¼Œå¸¸ç”¨äºæœç´¢</td>
                    </tr>
                    <tr>
                        <td><code>throttleFirst</code></td>
                        <td>èŠ‚æµï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»</td>
                    </tr>
                    <tr>
                        <td><code>zip</code></td>
                        <td>ç»„åˆå¤šä¸ªæº</td>
                    </tr>
                    <tr>
                        <td><code>retry</code></td>
                        <td>å¤±è´¥é‡è¯•</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="workmanager" class="section">
            <h2>WorkManager</h2>
            <p>Jetpackç»„ä»¶ï¼Œç”¨äºå¯é çš„åå°ä»»åŠ¡è°ƒåº¦ï¼Œå³ä½¿åº”ç”¨é€€å‡ºæˆ–è®¾å¤‡é‡å¯ä¹Ÿèƒ½æ‰§è¡Œã€‚</p>

            <h3>é€‚ç”¨åœºæ™¯</h3>
            <div class="cards">
                <div class="card">
                    <h3">ğŸ“¤ ä¸Šä¼ æ—¥å¿—</h3>
                        <p>åº”ç”¨é€€å‡ºåä»éœ€å®Œæˆçš„ä¸Šä¼ ä»»åŠ¡</p>
                </div>
                <div class="card">
                    <h3">ğŸ”„ æ•°æ®åŒæ­¥</h3>
                        <p>å®šæœŸä¸æœåŠ¡å™¨åŒæ­¥æ•°æ®</p>
                </div>
                <div class="card">
                    <h3">ğŸ–¼ï¸ å›¾ç‰‡å¤„ç†</h3>
                        <p>å‹ç¼©ã€ä¸Šä¼ å›¾ç‰‡ç­‰è€—æ—¶ä»»åŠ¡</p>
                </div>
            </div>

            <pre><code><span class="comment">// å®šä¹‰Worker</span>
<span class="keyword">class</span> UploadWorker(context: Context, params: WorkerParameters) 
    : CoroutineWorker(context, params) {
    
    <span class="keyword">override suspend fun</span> doWork(): Result {
        <span class="keyword">return try</span> {
            <span class="keyword">val</span> data = inputData.getString(<span class="string">"data"</span>)
            uploadData(data)
            Result.success()
        } <span class="keyword">catch</span> (e: Exception) {
            Result.retry()  <span class="comment">// æˆ– Result.failure()</span>
        }
    }
}

<span class="comment">// åˆ›å»ºä»»åŠ¡è¯·æ±‚</span>
<span class="keyword">val</span> uploadRequest = OneTimeWorkRequestBuilder&lt;UploadWorker&gt;()
    .setInputData(workDataOf(<span class="string">"data"</span> to <span class="string">"content"</span>))
    .setConstraints(
        Constraints.Builder()
            .setRequiredNetworkType(NetworkType.CONNECTED)
            .setRequiresBatteryNotLow(<span class="keyword">true</span>)
            .build()
    )
    .setBackoffCriteria(BackoffPolicy.EXPONENTIAL, 10, TimeUnit.SECONDS)
    .build()

<span class="comment">// æäº¤ä»»åŠ¡</span>
WorkManager.getInstance(context).enqueue(uploadRequest)

<span class="comment">// è§‚å¯Ÿä»»åŠ¡çŠ¶æ€</span>
WorkManager.getInstance(context)
    .getWorkInfoByIdLiveData(uploadRequest.id)
    .observe(lifecycleOwner) { info ->
        <span class="keyword">when</span> (info.state) {
            WorkInfo.State.SUCCEEDED -> showSuccess()
            WorkInfo.State.FAILED -> showError()
            <span class="keyword">else</span> -> { }
        }
    }

<span class="comment">// å‘¨æœŸæ€§ä»»åŠ¡</span>
<span class="keyword">val</span> syncRequest = PeriodicWorkRequestBuilder&lt;SyncWorker&gt;(
    1, TimeUnit.HOURS  <span class="comment">// æœ€å°15åˆ†é’Ÿ</span>
).build()</code></pre>
        </section>

        <section id="compare" class="section">
            <h2>æŠ€æœ¯é€‰å‹å¯¹æ¯”</h2>

            <table>
                <thead>
                    <tr>
                        <th>åœºæ™¯</th>
                        <th>æ¨èæŠ€æœ¯</th>
                        <th>åŸå› </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ç®€å•å¼‚æ­¥ä»»åŠ¡</td>
                        <td>Kotlinåç¨‹</td>
                        <td>ç®€æ´ã€æ˜“ç”¨ã€ä¸Jetpacké›†æˆ</td>
                    </tr>
                    <tr>
                        <td>å¤æ‚æ•°æ®æµå¤„ç†</td>
                        <td>RxJava / Flow</td>
                        <td>å¼ºå¤§çš„æ“ä½œç¬¦æ”¯æŒ</td>
                    </tr>
                    <tr>
                        <td>å¯é åå°ä»»åŠ¡</td>
                        <td>WorkManager</td>
                        <td>ç³»ç»Ÿè°ƒåº¦ã€æ”¯æŒçº¦æŸ</td>
                    </tr>
                    <tr>
                        <td>ç²¾ç¡®å®šæ—¶ä»»åŠ¡</td>
                        <td>AlarmManager</td>
                        <td>å³ä½¿Dozeä¹Ÿèƒ½æ‰§è¡Œ</td>
                    </tr>
                    <tr>
                        <td>å‰å°é•¿æ—¶é—´ä»»åŠ¡</td>
                        <td>Foreground Service</td>
                        <td>ç”¨æˆ·å¯è§ã€ä¸è¢«æ€æ­»</td>
                    </tr>
                    <tr>
                        <td>æ‰¹é‡å¹¶å‘è¯·æ±‚</td>
                        <td>çº¿ç¨‹æ±  + åç¨‹</td>
                        <td>å¯æ§å¹¶å‘æ•°</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip"><strong>ğŸ¯ 2024å¹´æ¨èæ–¹æ¡ˆ</strong>
                <p style="margin-top:8px">â€¢ <strong>é¦–é€‰Kotlinåç¨‹</strong>ï¼šé…åˆFlowå¤„ç†æ•°æ®æµ<br>
                    â€¢ <strong>åå°ä»»åŠ¡ç”¨WorkManager</strong>ï¼šå¯é æ€§æœ‰ä¿éšœ<br>
                    â€¢ <strong>RxJava</strong>ï¼šè€é¡¹ç›®ç»´æŠ¤æˆ–å¤æ‚æµå¤„ç†<br>
                    â€¢ <strong>é¿å…</strong>ï¼šAsyncTaskã€HandlerThreadï¼ˆé™¤éå¿…è¦ï¼‰</p>
            </div>
        </section>
    </div>
    <script>document.querySelectorAll('.toc a').forEach(a => a.addEventListener('click', e => { e.preventDefault(); document.querySelector(a.getAttribute('href')).scrollIntoView({ behavior: 'smooth' }) }))</script>
</body>

</html>